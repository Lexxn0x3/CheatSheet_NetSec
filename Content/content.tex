\section{Crypto Recap}
\subsection{Objectives:}
\begin{itemize}
  \item{\textbf{Confidentiality}}
  \item{\textbf{Integrity}}
  \item{\textbf{Authenticity}}
  \item{\textbf{Availability}}
  \item{Authorization}
  \item{Non-Repudiation, Accountability}
  \item{Freshness}
  \item{Anonymity, Unlinkability}
  \item{Intervenability, Contro}
  \item{Transparency}
\end{itemize}

\subsection{Confidentiality-Encryption}
\subsubsection{Symmetric Ciphers}
\begin{itemize}
  \item Secret key for en- and decryption
  \item Much more efficient
  \item \textbf{Block cipher: }encryps a plaintext block of fixed len e.g.: \textit{Advanced Encryption Standard (AES)}
  \item \textbf{Stream cipher: }encrypts a bitstream e.g.:\textit{ChaCha20}
\end{itemize}

\subsubsection{Asymmetric Ciphers}
\begin{itemize}
  \item Public key for encryption
  \item Private key for decryption
  \item Ex.: RSA-based encryption
\end{itemize}

\subsection{Integrity, Authenticity-Signatures, MACs}
\subsubsection{MACs}
\begin{itemize}
  \item Symmetric cryptography
  \item Protects data integrity \& authenticity
  \item Ex.: Hash-based MAC
\end{itemize}

\subsubsection{Digital Signatures}
\begin{itemize}
  \item Asymmetric cryptography
    \begin{itemize}
      \item{\textbf{Signing with} private key}
    \end{itemize}
  \item{Protects data integrity \& authenticity}
  \item{Provices non-repudation}
\end{itemize}

\subsection{Block Cipher Modes of Operation}
\subsubsection{Electronic Code Book (ECB)}
\begin{itemize}
  \item{Each plaintext block is encrypted seperatly}
  \item{Inherintly insecure! -> Smae block = Same cipher}
\end{itemize}

\subsubsection{Cipher Block Chainning (CBC)}
\begin{itemize}
  \item Plaintext is chained to previous ciphertext by XOR and encrypted afterwards
  \item Difficult to apply securely -> implementations often vulnerable
\end{itemize}

\subsubsection{Galois Counter Mode (GCM)}
\begin{center}
  \includegraphics[width=0.5\columnwidth]{Resources/GCM-Galois_Counter_Mode_with_IV.svg.png}
\end{center}

\section{Tranport Layer Security (TLS)}
\subsection{TLS handshake protocol}
\begin{itemize}
  \item Parameter Negotiation
  \item Key exchange
  \item Authentication
\end{itemize}
\subsection{TLS record protocol}
\begin{itemize}
  \item Protection of integrity, authenticiy and confidentiality
  \item \textbf{Symmetric Cryptography:} e.g., block cipher, usually AES
\end{itemize}

\subsection{Attacks}
\begin{itemize}
  \item Attacks on the record layer
  \item Attacks on the session key
  \item Attacks on the private server key
    \begin{itemize}
      \item Attacks on implmentations: Timing Attacks, Heratbleed, Invalid Point Attacks
    \end{itemize}
  \item Attacks on TLs eco system
    \begin{itemize}
      \item Attacks on certificates and the PKI
      \item Attacks on the browser GUI
    \end{itemize}
\end{itemize}

\subsection{Overview TLS 1.0-1.2 \& TLS 1.3}
\includegraphics[width=0.8\columnwidth]{Resources/tls.png}

\subsection{HKDF Key Derivation Function}

\subsection{Forward Secrecy}
\begin{itemize}
  \item TLS 1.3 using certificate-based Authentification: \textbf{forward secrecy}
  \item TLS 1.3 using pre-shared keys (PSK):
    \begin{itemize}
      \item PSK using \textit{elliptic-curve} Diffie-Hellman: \textbf{forward secrecy}
      \item PSK without EC-DHE (symmetric-only) and zero-round-trip data: \textbf{no forward secrecy}
    \end{itemize}
\end{itemize}

\subsection{Datagramm TLS}
\begin{itemize}
  \item DTLS is identical to TLS where possible
  \item DTLS has to introcue new mechanisms
    \begin{itemize}
      \item Explicit sequence numbers
      \item Retransmission timer for handshake message
      \item Message re-ordering for the handshake
      \item Fragmentation of large handshake messages into serveral DTLS records
      \item Optional replay detection
      \item Invalid records are discarded (silently)
      \item Denial-of-Service countermeasures: statless cookies, HelloRetryRequest
    \end{itemize}
\end{itemize}

\section{Network Layer Security: IPsec}
\subsection{TLS limitations}
\begin{itemize}
  \item Does not protect all traffic between hosts
    \begin{itemize}
      \item Protects only a single connection; new connection => new key agreement or session resumption necessary
      \item Non-TCP traffic (resp. non-UDP trafic for DTLS) cannto be protected
    \end{itemize}
  \item Does not protect the TCP layer (RST attacks on TCP are possible which terminate TLS connection)
  \item Application specific: applications have to be modified to use TLS/DTLS
  \item Using a TLS-based tunel for VPNs has disadvangates (TCP) (DTLS good option tho)
\end{itemize}

\subsection{Overview IPsec}
\begin{itemize}
  \item Goal: Protect IP packets cryptographically
    \begin{itemize}
      \item Confidentiality
      \item Integrity \& Authenticity
    \end{itemize}
  \item Seperation of packet protection from key exchange
    \begin{itemize}
      \item Protocols for packet encryption and authentification:
        symmetric crypto, implemented in the TCP/IP stack
      \item Key Exchange completly unrelated:
        asymmetric (+symmetric) crypto, implemented as network daemon
    \end{itemize}
\end{itemize}
\includegraphics[width=\columnwidth]{Resources/ipsec_overview.png}

\subsection{Packet Formats and Operational Modes}
\subsubsection{Authentification Header (AH)}
\begin{itemize}
  \item Integrity \& Authenticity only
  \item Partially protects "outer" IP header
    \begin{itemize}
      \item Variable fields cannot be includes
        \begin{itemize}
          \item Flags, Fragment Offset, TTL, Header Checksume
        \end{itemize}
      \item Other fields are included in MAC computation
        \begin{itemize}
          \item Version, IP header length, total length, identification, Protocol (must be AH), source/dest Address
        \end{itemize}
    \end{itemize}
\end{itemize}
\subsubsection{Encapsulating Security Payload (ESP)}
\begin{itemize}
  \item Confidentiality, Integrity \& Authenticity
  \item Does not protect "outer" IP header
\end{itemize}
\includegraphics[width=\columnwidth]{Resources/esp.png}
\begin{itemize}
  \item SPI: SA-Identifier
  \item Next Header: type of payload data (e.g. IPV4)
  \item Integrity Check Value: data for authentification / integrity protection
    \begin{itemize}
      \item Message Authentification Code (MAC)
    \end{itemize}
  \item SAs are negotiated in the key exchange
  \item Sender side: Packet must be categorized to determine which SA applies (By parameters such as destination=)
  \item Receiver side: Determines SA from IPsec header of received packet
  \item SA Parameters:
    \begin{itemize}
      \item IPsec protocol (AH or ESP)
      \item Authentification alrogrithm and key
      \item Encryption algorithm and key
      \item IPsec mode (transport or tunnel)
      \item SA lifetimne
      \item Sequence number: current counter
      \item On reciver side: "Sliding Window" for replay protection
    \end{itemize}
\end{itemize}

\subsection{Scenarios}
\begin{itemize}
  \item Host to host
  \item Host to gateway
  \item Gateway to gateway
\end{itemize}

\subsection{The Internet Key Exchange (IKE)}
\begin{itemize}
  \item So far, keys are already exchanges, SAs negotiated... but how?
  \item Authentification of the communication endpoints
  \item Dynamic negotiation fo algorithms and parameters
  \item Key establishment
    \begin{itemize}
      \item Forward Secrecy
    \end{itemize}
  \item Resistance to DoW attacks
  \item Efficiency (computation, messages, round trips)
\end{itemize}

\subsection{IKEv1}
\begin{itemize}
  \item Phase 1: main mode vs. aggressive mode
  \item Authentification modes:
    \begin{itemize}
      \item Digital Signatures
      \item Public key encryption(PKE): two variants (rarely used)
      \item Pre-shared keys(PSK)
    \end{itemize}
  \item Phase 2 (quick mode)
    \begin{itemize}
      \item With DH (=> forward secrecy)
      \item Without DH (=> no forward secrecy)
    \end{itemize}
\end{itemize}
\includegraphics[width=\columnwidth]{Resources/ikev1.png}

\subsubsection{Discussion}
\begin{itemize}
  \item Complicated
    \begin{itemize}
      \item Information from serveral (complex) RFCs required
      \item Many options variants
    \end{itemize}
  \item Gneric
    \begin{itemize}
      \item Clean seperation of different phases and functionalities
        \begin{itemize}
          \item Can be advantagous in theory, but leads to inefficincies
        \end{itemize}
      \item Intended as general handshake and key agreement protocol, not only for IPsec
        \begin{itemize}
          \item In practice: only used for IPsec
        \end{itemize}
      \item Inneficient
        \begin{itemize}
          \item Requires too many round trips
        \end{itemize}
      \item Inadequate DoS protection
        \begin{itemize}
          \item IKEv1 uses stateful cookies
        \end{itemize}
    \end{itemize}
\end{itemize}

\subsection{IKEv2}
\begin{itemize}
  \item Phase 2 (partially) combindes with Phase 1
    \begin{itemize}
      \item More efficient thatn IKEv1
      \item Initial negotiation of IPsec SA included
    \end{itemize}
  \item Additional SAs can be negotiaded in furhter Phase 2 protocol runs
  \item Simplified specification
    \begin{itemize}
      \item Essential information in one RFC
      \item No distinction main mode vs. aggressive mode
    \end{itemize}
  \item DoS protection using statless cookies: optional
\end{itemize}
\includegraphics[width=\columnwidth]{Resources/ikev2.png}

\subsection{SA Proposals}
\begin{itemize}
  \item Serverl proposals possible
  \item Proposal contains transforms
  \item Differnten options for each transform possible
    \begin{itemize}
      \item Exactly one transform has to be selected
    \end{itemize}
\end{itemize}
\includegraphics[width=0.7\columnwidth]{Resources/ike_sa_proposal.png}

\section{Security on Layer 2 (MAC Layer, Ethernet)}
\subsection{Attacks}
\begin{itemize}
  \item MAC address spoofing
  \item ARP spoofing
  \item ARP cache poisoning
\end{itemize}

\subsection{Network Access Control}
\begin{itemize}
  \item \textbf{Frontend} protocols: Cient -> Network Access Server
    \begin{itemize}
      \item Point-to-Point connections: PPP
      \item LAN: PPPoE, EAPoL
      \item WLAN: WPA/WPA2/WPA3, EAPoL
    \end{itemize}
  \item \textbf{Backend} protocols: Network Access Server --> Authentication Server AAA protocols (Authentication, Authorization, Accounting)
    \begin{itemize}
      \item Radius, Diameter
      \item TACACS+
    \end{itemize}
\end{itemize}
\includegraphics[width=0.6\columnwidth]{Resources/network_access_control.png}

\subsubsection{Radius - Remote Authentification Dial-In User Service}
\begin{itemize}
  \item Backend protocol
  \item Dial-In Server
    \begin{itemize}
      \item E.g. DSL
      \item Company infrastructure
    \end{itemize}
\end{itemize}
\textbf{Packet Format}\\
\includegraphics[width=0.7\columnwidth]{Resources/radius.png}
\textbf{Security}\\
\begin{itemize}
  \item Old protocol
    \begin{itemize}
      \item Tries to protect sesitive data only
      \item Insecure cryptography
    \end{itemize}
  \item Uses only over secure protocols
    \begin{itemize}
      \item Usually TLS
    \end{itemize}
  \item RADIUS successor: Diameter
    \begin{itemize}
      \item Fmore flexible, extensible, application-aware
      \item "Security" features removed, no more insecure crypto of RADIUS
        => To be used over secure protocols TLS/DTLS/IPsec
    \end{itemize}
\end{itemize}

\subsubsection{Point-to-Point Protocol (PPP)}
\begin{itemize}
  \item \textbf{PPP: }Frontend protocol to connect two devices
    \begin{itemize}
      \item Typically used for dial-up connections (e.g. DSL)
      \item Transported over Layer 2 protocol (e.g. ethernet)
    \end{itemize}
  \item Authentification mechanisms
    \begin{itemize}
      \item PAP: username/password
      \item CHAP: Challange Handshake Authentification Protocol
      \item EAP: Extensible Authentification Protocol
    \end{itemize}
  \item \textbf{PPPoE: }PPP over Ethernet (e.g. used for DSL connections)
    \begin{itemize}
      \item Discovery: Client negotiates session with network access server
      \item PPP Session: PPP frames are encapsulated in ethernet frames; potentially several hops
    \end{itemize}
\end{itemize}

\subsubsection{Extensible Authentification Protocol (EAP)}
\begin{itemize}
  \item Extensible authentification framework
    \begin{itemize}
      \item Fronted protocol for lcient authentification
      \item Server send request (e.g. challenge, ident. request, ..)
      \item Client responds
      \item Server sends success or failure message
      \item EAP messages can be transported in RADIUS messages (as RADIUS attribute) for backend communication
    \end{itemize}
  \item EAPoL: EAP over LAN
\end{itemize}

\subsubsection{Port Based Network Access Control (PNAC)}
\begin{itemize}
  \item Authentification of clients befre they can use the network (LAN)
    \begin{itemize}
      \item Client connect to the network
        \begin{itemize}
          \item Authentification traffic is allowed
        \end{itemize}
      \item Switch port can only be used for other purposes after successful authentification
      \item Re-authentification after timeouts, link-down, etc.
    \end{itemize}
  \item PNAC uses EAPoL
  \item Terminology: Port Access Entities (PAE)
    \begin{itemize}
      \item Client: supplicant
      \item Netowrk access server: authenticator
      \item Attention: "port"
    \end{itemize}
\end{itemize}

\subsection{MACsec}
\begin{itemize}
  \item cryptographically protect the ethernet layer
  \item Based on MACsec Key Agreeement (MKA)
    \begin{itemize}
      \item After successful authentification (typically EAP)
      \item Derives key from CAK - connectivity association key (pre-shared)
      \item Key can be set up by EAP (e.g. EAP-TLS)
    \end{itemize}
\end{itemize}
 \subsubsection{Frame}
 \includegraphics[width=0.8\columnwidth]{Resources/macsec_frame.png}
 \begin{itemize}
  \item Data cen be encryped and/or authentificated
  \item AES-GCM is supported
 \end{itemize}
 \textbf{Security TAG (SecTAG)}\\
 \includegraphics[width=0.8\columnwidth]{Resources/sec_tag.png}
 \begin{itemize}
  \item TCI: TAG Control Information
  \item AN: Association Number
  \item SL: Short Length (payload length; for short frames only)
  \item PN: Packet Number
  \item SCI: Secre Channel Identifier (edentify SA, when CA needs ore than 4)
    \begin{itemize}
      \item SA is identified by SCI (optional) and AN
    \end{itemize}
 \end{itemize}
 \subsection{Summary}
\begin{itemize}
  \item Security on Layer 2 can protect all higher Layer
    \begin{itemize}
      \item But: only in same network
      \item Does nt work accross Layer 3 routers
    \end{itemize}
  \item Network Access Control protects access to the network
    \begin{itemize}
      \item Client Authentification
      \item RADIUS/DIAMETER
      \item EAP
      \item Port-Based Access Control
    \end{itemize}
  \item MACsec protects traffic
  \begin{itemize}
    \item Encryption \& authentification
  \end{itemize}
\end{itemize}

\section{Wireless Security}
\subsection{WiFi Security}
\subsubsection{Historic Overview}
\begin{itemize}
  \item 1999: WEP (Wired Equivilaent Privacy)
    \begin{itemize}
      \item Goal: "as secure as a wired LAN"
      \item Insecure, various attacks known
    \end{itemize}
  \item 2003: WPA (WiFi Protected Access)
    \begin{itemize}
      \item Improved protocols; most known attacks on WEP prevented
      \item Enterprice Mode
      \item But: Requirement ofr hardware-compatibility with WEP devices => Encryption improved, but still based on obsolete stream cipher
    \end{itemize}
  \item 2004: WPA2 (still used) 
    \begin{itemize}
      \item Similar to WPA, but AES-based encryption: AES-CCMP
    \end{itemize}
  \item 2018: WPA3 (supported by new devices) 
    \begin{itemize}
      \item Serveral improvements: 
        Prevention of offline-attacks on pre-shared keys, forward secrecy, encryption for "open" WLANs
    \end{itemize}
\end{itemize}
\subsubsection{WPA/WPA2 Security}
\begin{itemize}
  \item Personal Mode
    \begin{itemize}
      \item Pre-Shared Keys
    \end{itemize}
  \item Enterprise Mode 
    \begin{itemize}
      \item EAP-TLS, PEAP, EAP-TTLS
    \end{itemize}

\textbf{AES-CCMP}\\
  \item Authenticated Encryption with Associated Data (AED)
  \item AES-CCM
    \begin{itemize}
      \item Authentication: CBC-MAC
      \item Encryption: Counter Mode (CTR)
      \item MAC and encyprion: computed simultaneously
    \end{itemize}
\end{itemize}

\textbf{4-Way Handshake}\\
\begin{itemize}
  \item Based on Pairwise Master Key (PMK)
    \begin{itemize}
      \item Personal Mode (WPA-PSK):
        Computed from passphrase and SSID (as "salt") using PBKDF2 (password-based key derivation function)
      \item Enterprise Mode: Established by key exchange protocol (e.g. EAP-TLS, PEAP)
    \end{itemize}
  \item 4-Way HS to derive Pairwise Transient Key (PTK) 
    \begin{itemize}
      \item Exchance nonces
      \item PTK is derived by hashing PMK, nonces, MAC addrs 
      \item Furhter key (for differnet purposes) derived from PTK 
      \item Client gets Group Temporary Key from AP (encrypted) 
      \item Message Integrity Code(MIC): MACs for integrity protection, key confirmation 
    \end{itemize}
  \item KRACK (2018): Key reinstallation attacks => meanwhile prevented by software/firmware updates 
  \item Problem: Offline attacks against passphrase 
\end{itemize}

\subsubsection{WPA 3 Improvements}
\begin{itemize}
  \item Mandatory Protected Managment Frames
    \begin{itemize}
      \item Prevents deauthentication attacks (DoS)
    \end{itemize}
  \item Replace PSK Authentication with SAW protocol 
    \begin{itemize}
      \item Simultaneous Authentication among Equals (SAE):
        "Dragonfly" handshake
      \item Prevents offline attacks on passphrase 
      \item Based on elliptic curve cryptography by default
    \end{itemize}
  \item Forward Secrecy based on Diffie-Hellman 
  \item 192-bit Security Mode (optional) 
    \begin{itemize}
      \item AES-256 (GCM)
      \item SHA-384 
      \item 284-bit elliptic curves or RSA with at least 3K bits 
    \end{itemize}
\end{itemize}

\subsubsection{Simultaneous Authentication among Equals}
\begin{itemize}
  \item SAE "Dragonfly" authenicates participants and establishes PMK
    \begin{itemize}
      \item Based on passphrase and (EC-)Diffie-Hellman
      \item Can be initiated simultaneously by both parties (useful for mesh networking) 
    \end{itemize}
  \item 4-Way Handshake 
    \begin{itemize}
      \item Esablishes PTK basen on PMK
      \item Same as in WPA2 
      \item But now: PMK with much higher entropy => Offlione attacks not practical 
    \end{itemize}
  \item Hash-to-Group: "Hunting and Pecking" 
    \begin{itemize}
      \item Generate point on elliptic curve from pasphrase (and MAC addresses, etc.)
      \item Cryptographic has function generates pseudo random numbers (by including a counter in the input) 
        \begin{itemize}
          \item Both parties must use the exact same inputs in the same order
        \end{itemize}
      \item Fixed procedure to derive x-coordinate 
        \begin{itemize}
          \item Check if point on curve can be generated
          \item If check fails: increase coutner and try again 
        \end{itemize}
    \end{itemize}
  \item Auth-Commit messages
    \begin{itemize}
      \item Exchange ECDH shares
    \end{itemize}
  \item Auth-Confirm messages 
    \begin{itemize}
      \item Key confirmation, authentication of messages
    \end{itemize}
\end{itemize}

\subsection{Bluetooth Security}
\begin{itemize}
  \item Authentication: device authentication, no user authentication
  \item Pairing/bondig: create shared keys; used in connections later on 
  \item Confidentiality: encryption of BT communication 
  \item Message Integrity: MACs (authenticated encryption) to protect BT communication 
  \item Authorization: control access to resources (based on devices, not users) 
  \item Security Modes 
    \begin{itemize}
      \item Mode 1: no security
      \item Mode 2: service level (only for backward compatibility) 
      \item Mode 3: link-level enforces security (only for backward compatibility) 
      \item Mode 4: authenticated link key using "Secure Connections", based on device pairing 
    \end{itemize}
  \item Eavesdropptin not trivial: Bluetooth uses frequency hoppting (not a security feature) 
\end{itemize}

\subsubsection{Device Pairing}
\begin{itemize}
  \item Authentication and generation of link key / long term key
  \item PIN/Legacy Pairing: enter PIN on both devices 
    \begin{itemize}
      \item Key generation based on PIN, device address, and random values
    \end{itemize}
  \item Secure Simple Pairing (SSP): since Bluetooth 2.1 
    \begin{itemize}
      \item Numeric Comparison
        \begin{itemize}
          \item Compare 6-digit numbers
        \end{itemize}
      \item Passkey Entry 
        \begin{itemize}
          \item Read 6-digit form one device, enter on the other one
        \end{itemize}
      \item Just Works 
        \begin{itemize}
          \item User accepts connection without verification
        \end{itemize}
      \item Out of Band (OOB) 
        \begin{itemize}
          \item Transmit data using other communication channels (e.g. NFC)
        \end{itemize}
    \end{itemize}
\end{itemize}

\subsubsection{Simple Secure Pairing (SSP)}
\begin{itemize}
  \item Unauthenticated ECDH
  \item 2-Stage Authentication 
    \begin{itemize}
      \item Stage 2: depends on pariing method
      \item Stage 2: Cryptographic authentication based on Stage 1 values and ECDH secret 
    \end{itemize}
  \item Key derivation to generate link key / long term key 
\end{itemize}

\subsubsection{Secure Authentication}
\begin{itemize}
  \item Paired (bonded) devices authenticate each other
  \item Challange-Response scheme 
    \begin{itemize}
      \item 128-bit random challanges
      \item Response: HMAC of BT addresses and challanges (using link key from pairing) 
        \begin{itemize}
          \item Before Bluetooth 4.1: based on Bluetooth-specific algorithm E1
        \end{itemize}
    \end{itemize}
  \item Authenication failure: introcude delay (exponential back-off) 
\end{itemize}

\subsubsection{Confidentiality}
\begin{itemize}
  \item Bluetooth-specific stream cipher E0
    \begin{itemize}
      \item Designed for efficiency
      \item Serious attacks hve been published 
      \item "Practical" in theory (but complex, hard to apply in practice) 
    \end{itemize}
  \item AES-CCM 
    \begin{itemize}
      \item Used since Bluetooth 4.1
      \item Key derived from link key (pairing) and the authentication step 
    \end{itemize}
\end{itemize}

\subsubsection{Privacy}
\begin{itemize}
  \item Privacy problem: Devices (users) can be identified by Bluetooth MAC addresses
  \item Mitigation: BLE private device addresses 
    \begin{itemize}
      \item Resolvable Private Address (RPA) is changed periodically
      \item Identity Address remains constant (but is not transmitted over the air) 
      \item Identity Resolving Key to map RPA to Identity Address 
      \item Especially imprtant to discoverable devices (which advertice identity info) 
    \end{itemize}
\end{itemize}

\subsubsection{5.x Security}
\begin{itemize}
  \item No major changes to security protocols and algorithms
  \item Bluetooth 5.0 
    \begin{itemize}
      \item PHY improvements, no relevant security changes
    \end{itemize}
  \item Bluetooth 5.1 
    \begin{itemize}
      \item HCI support for debug keys (should not be relevant in production systems)
    \end{itemize}
  \item Bluetooth 5.2: adds new features (Extended Attributes, Isochronous Communication, ...)
    \begin{itemize}
      \item Isochronous communication: connection-oriented or connection-less
        \begin{itemize}
          \item Group communication: group keys need to be established
          \item Broadcast Authenication 
        \end{itemize}
    \end{itemize}
  \item Bluetooth 5.3: Key Size Negotiation 
    \begin{itemize}
      \item Enables host to define minimun key size
    \end{itemize}
\end{itemize}
\subsubsection{BLUFFS}
\begin{itemize}
  \item BLUFFS: New attacks against bluetooth
    \begin{itemize}
      \item Breaks Forward Secrecy and Future Secrecy
      \item Enables man-in-the-middle attacks, impersonation if one session key compromised 
      \item Forces weak key: spec allows minimus of 7 Bytes entropy (56 Bits) 
        \begin{itemize}
          \item Brute-force attack: offline, parallelizable
          \item Forces reuse of compromised key 
        \end{itemize}
      \item Attack against bluetooth spec (BR/EDR: "Bluetooth Classic" versions 4.2 to 5.4): All compliant devices are affected 
      \item Published and presented at ACM CCS 2023 
    \end{itemize}
\end{itemize}

\subsubsection{implementations Vulnerabilities}
\begin{itemize}
  \item BlueBorn(2017): Collection of implementation Vulnerabilities
    \begin{itemize}
      \item On Windows, IOS, Linux, Android
      \item Buffer overflow, integer overflows, .. 
    \end{itemize}
  \item Android (2018): implementation flaws in L2CAP and SMP 
    \begin{itemize}
      \item Remote Memory Disclousure
    \end{itemize}
  \item BleedingTooth(2020): several bugin in Linux 
    \begin{itemize}
      \item Can even lead to arbitrary code execution in kernal mode
    \end{itemize}
  \item Windows (2021): BT Driver Elevation of Privilege 
  \item BrakTooth(2021) 
    \begin{itemize}
      \item Bluetooth controllers: SoC firmware Vulnerabilities(Link Manager)
      \item Estimation 1400 bluetooth chips/modules affected 
    \end{itemize}
\end{itemize}

\subsubsection{Summary}
\begin{itemize}
  \item Complex protocol stack, not easy to implement
  \item Many attacks in the past  
    \begin{itemize}
      \item on cryptography algorithms
    \end{itemize}
  \item Bluetooth versions before 2.1 are basically completely insecure 
  \item Bluetooth versions sinde 4.2 are relativly secure (...but: "BLUFFS"!) 
    \begin{itemize}
      \item But the implementations not necessarily!
    \end{itemize}
  \item Bluetooth 5.2 architecture similar to 4.x 
    \begin{itemize}
      \item Introduces new features and minor security improvements
    \end{itemize}
\end{itemize}

\section{Security Mobile Networks}

